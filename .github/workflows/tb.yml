name: test x-cmd hub ai
on:
  workflow_dispatch:
    inputs:
      apikey:
        description: 'X-CMD HUB APIKEY'
        required: false
      dataset:
        description: 'dataset'
        required: false
      registry:
        description: 'registry'
        required: false
  # schedule:
  #   - cron: '0 5,23 * * *'

jobs:
  release-worker:
    runs-on: ubuntu-latest
    env:
      ___X_CMD_GHACTION_X: beta
      ___X_CMD_HUB_TOKEN: ${{ github.event.inputs.apikey }}
      ___X_CMD_HUB_DATASET: ${{ github.event.inputs.dataset }}
      ___X_CMD_HUB_REGISTRY: ${{ github.event.inputs.registry }}
    steps:
      - name: main
        uses: x-cmd/action@main
        with:
          code: |
            [ -n "$___X_CMD_HUB_TOKEN" ] || {
                printf "%s\n" "- E|x: Please set the ___X_CMD_HUB_TOKEN environment variable" >&2
                exit 1
            }

            export ___X_CMD_HUB_TOKEN="$___X_CMD_HUB_TOKEN"
            x ws harbor
          artifact_name: log-jobs-${{ github.event.inputs.dataset }}
          artifact_path: ~/jobs
